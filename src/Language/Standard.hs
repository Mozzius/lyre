module Language.Standard where

import Language.CoreErlang.Syntax
  ( Alt (..),
    Ann (..),
    Atom (..),
    Const (..),
    Exp (..),
    Exps (..),
    FunDef (..),
    Function (..),
    Guard (..),
    List (..),
    Literal (..),
    Pat (..),
    Pats (..),
    TimeOut (..),
  )

env :: [(String, Int)]
env =
  [ ("int", 1),
    ("length", 1),
    ("make", 0),
    ("print", 1),
    ("recv", 1),
    ("send", 2),
    ("str", 1)
  ]

header :: [Function]
header =
  [ Function (Atom "int", 1),
    Function (Atom "length", 1),
    Function (Atom "make", 1),
    Function (Atom "make", 3),
    Function (Atom "print", 1),
    Function (Atom "recv", 1),
    Function (Atom "send", 2),
    Function (Atom "str", 1)
  ]

funcs :: String -> [FunDef]
funcs moduleName =
  [ FunDef (Constr (Function (Atom "str", 1))) (Constr (Lambda ["_0"] (Exp (Constr (Case (Exp (Constr (Var "_0"))) [Constr (Alt (Pats [PLit (LAtom (Atom "true"))]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (List (LL [Exp (Constr (Lit (LInt 116)))] (Exp (Constr (List (LL [Exp (Constr (Lit (LInt 114)))] (Exp (Constr (List (LL [Exp (Constr (Lit (LInt 117)))] (Exp (Constr (List (L [Exp (Constr (Lit (LInt 101)))]))))))))))))))))), Constr (Alt (Pats [PLit (LAtom (Atom "false"))]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (List (LL [Exp (Constr (Lit (LInt 102)))] (Exp (Constr (List (LL [Exp (Constr (Lit (LInt 97)))] (Exp (Constr (List (LL [Exp (Constr (Lit (LInt 108)))] (Exp (Constr (List (LL [Exp (Constr (Lit (LInt 115)))] (Exp (Constr (List (L [Exp (Constr (Lit (LInt 101)))]))))))))))))))))))))), Constr (Alt (Pats [PVar "N"]) (Guard (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "is_integer"))))) [Exp (Constr (Var "_0"))])))) (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "integer_to_list"))))) [Exp (Constr (Var "N"))])))), Constr (Alt (Pats [PVar "S"]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (Var "S"))))]))))),
    FunDef (Constr (Function (Atom "int", 1))) (Constr (Lambda ["_0"] (Exp (Constr (Case (Exp (Constr (Var "_0"))) [Constr (Alt (Pats [PLit (LAtom (Atom "true"))]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (List (LL [Exp (Constr (Lit (LInt 116)))] (Exp (Constr (List (LL [Exp (Constr (Lit (LInt 114)))] (Exp (Constr (List (LL [Exp (Constr (Lit (LInt 117)))] (Exp (Constr (List (L [Exp (Constr (Lit (LInt 101)))]))))))))))))))))), Constr (Alt (Pats [PLit (LAtom (Atom "false"))]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (List (LL [Exp (Constr (Lit (LInt 102)))] (Exp (Constr (List (LL [Exp (Constr (Lit (LInt 97)))] (Exp (Constr (List (LL [Exp (Constr (Lit (LInt 108)))] (Exp (Constr (List (LL [Exp (Constr (Lit (LInt 115)))] (Exp (Constr (List (L [Exp (Constr (Lit (LInt 101)))]))))))))))))))))))))), Constr (Alt (Pats [PVar "N"]) (Guard (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "is_list"))))) [Exp (Constr (Var "_0"))])))) (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "list_to_integer"))))) [Exp (Constr (Var "N"))])))), Constr (Alt (Pats [PVar "S"]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (Var "S"))))]))))),
    FunDef (Constr (Function (Atom "length", 1))) (Constr (Lambda ["_0"] (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "list")))), Exp (Constr (Lit (LAtom (Atom "length"))))) [Exp (Constr (Var "_0"))]))))),
    FunDef (Constr (Function (Atom "print", 1))) (Constr (Lambda ["_0"] (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "io")))), Exp (Constr (Lit (LAtom (Atom "fwrite"))))) [Exp (Constr (List (LL [Exp (Constr (Lit (LInt 126)))] (Exp (Constr (List (LL [Exp (Constr (Lit (LInt 115)))] (Exp (Constr (List (LL [Exp (Constr (Lit (LInt 126)))] (Exp (Constr (List (L [Exp (Constr (Lit (LInt 110)))]))))))))))))))), Exp (Constr (List (LL [Exp (Constr (Var "_0"))] (Exp (Constr (Lit LNil))))))]))))),
    FunDef (Constr (Function (Atom "make", 1))) (Constr (Lambda ["_0"] (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "spawn"))))) [Exp (Constr (Lit (LAtom (Atom moduleName)))), Exp (Constr (Lit (LAtom (Atom "make")))), Exp (Constr (List (LL [Exp (Constr (Lit LNil))] (Exp (Constr (List (LL [Exp (Constr (Lit LNil))] (Exp (Constr (List (LL [Exp (Constr (Var "_0"))] (Exp (Constr (Lit LNil))))))))))))))]))))),
    FunDef (Constr (Function (Atom "make", 3))) (Constr (Lambda ["_0", "_1", "_2"] (Exp (Constr (Case (Exps (Constr [Constr (Var "_0"), Constr (Var "_1"), Constr (Var "_2")])) [Constr (Alt (Pats [PLit LNil, PLit LNil, PVar "Z"]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (Rec [Constr (Alt (Pats [PTuple [PLit (LAtom (Atom "send")), PVar "Msg", PVar "PID"]]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (Case (Exp (Constr (Var "Z"))) [Constr (Alt (Pats [PLit (LInt 0)]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (App (Exp (Constr (Fun (Function (Atom "make", 3))))) [Exp (Constr (Lit LNil)), Exp (Constr (List (LL [Exp (Constr (Tuple [Exp (Constr (Var "Msg")), Exp (Constr (Lit (LAtom (Atom "none"))))]))] (Exp (Constr (Lit LNil)))))), Exp (Constr (Var "Z"))])))), Constr (Alt (Pats [PVar "_26"]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (Let (["_3"], Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "self"))))) []))) (Exp (Constr (Seq (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "!"))))) [Exp (Constr (Var "PID")), Exp (Constr (Tuple [Exp (Constr (Lit (LAtom (Atom "ack")))), Exp (Constr (Var "_3"))]))]))) (Exp (Constr (App (Exp (Constr (Fun (Function (Atom "make", 3))))) [Exp (Constr (Lit LNil)), Exp (Constr (List (LL [Exp (Constr (Tuple [Exp (Constr (Var "Msg")), Exp (Constr (Var "PID"))]))] (Exp (Constr (Lit LNil)))))), Exp (Constr (Var "Z"))]))))))))))])))), Constr (Alt (Pats [PTuple [PLit (LAtom (Atom "recv")), PVar "PID"]]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (App (Exp (Constr (Fun (Function (Atom "make", 3))))) [Exp (Constr (List (LL [Exp (Constr (Var "PID"))] (Exp (Constr (Lit LNil)))))), Exp (Constr (Lit LNil)), Exp (Constr (Var "Z"))]))))] (TimeOut (Exp (Constr (Lit (LAtom (Atom "infinity"))))) (Exp (Constr (Lit (LAtom (Atom "true")))))))))), Constr (Alt (Pats [PList (LL [PVar "X"] (PVar "Xs")), PLit LNil, PVar "Z"]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (Rec [Constr (Alt (Pats [PTuple [PLit (LAtom (Atom "send")), PVar "Msg", PVar "PID"]]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (Seq (Exp (Constr (Case (Exp (Constr (Var "Z"))) [Constr (Alt (Pats [PLit (LInt 0)]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (Lit (LAtom (Atom "ok")))))), Constr (Alt (Pats [PVar "_27"]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (Let (["_5"], Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "self"))))) []))) (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "!"))))) [Exp (Constr (Var "PID")), Exp (Constr (Tuple [Exp (Constr (Lit (LAtom (Atom "ack")))), Exp (Constr (Var "_5"))]))])))))))]))) (Exp (Constr (Let (["_7"], Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "self"))))) []))) (Exp (Constr (Seq (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "!"))))) [Exp (Constr (Var "X")), Exp (Constr (Tuple [Exp (Constr (Var "_7")), Exp (Constr (Var "Msg"))]))]))) (Exp (Constr (App (Exp (Constr (Fun (Function (Atom "make", 3))))) [Exp (Constr (Var "Xs")), Exp (Constr (Lit LNil)), Exp (Constr (Var "Z"))]))))))))))))), Constr (Alt (Pats [PTuple [PLit (LAtom (Atom "recv")), PVar "PID"]]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (Let (["_8"], Exp (Constr (List (LL [Exp (Constr (Var "X"))] (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "++"))))) [Exp (Constr (Var "Xs")), Exp (Constr (List (LL [Exp (Constr (Var "PID"))] (Exp (Constr (Lit LNil))))))]))))))) (Exp (Constr (App (Exp (Constr (Fun (Function (Atom "make", 3))))) [Exp (Constr (Var "_8")), Exp (Constr (Lit LNil)), Exp (Constr (Var "Z"))])))))))] (TimeOut (Exp (Constr (Lit (LAtom (Atom "infinity"))))) (Exp (Constr (Lit (LAtom (Atom "true")))))))))), Constr (Alt (Pats [PLit LNil, PList (LL [PVar "Y"] (PVar "Ys")), PVar "Z"]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (Rec [Constr (Alt (Pats [PTuple [PLit (LAtom (Atom "send")), PVar "Msg", PVar "PID"]]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (Let (["_9"], Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "length"))))) [Exp (Constr (Var "Ys"))]))) (Exp (Constr (Let (["_10"], Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "+"))))) [Exp (Constr (Var "_9")), Exp (Constr (Lit (LInt 1)))]))) (Exp (Constr (Case (Exps (Constr [])) [Constr (Alt (Pats []) (Guard (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "<"))))) [Exp (Constr (Var "_10")), Exp (Constr (Var "Z"))])))) (Exp (Constr (Let (["_11"], Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "self"))))) []))) (Exp (Constr (Seq (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "!"))))) [Exp (Constr (Var "PID")), Exp (Constr (Tuple [Exp (Constr (Lit (LAtom (Atom "ack")))), Exp (Constr (Var "_11"))]))]))) (Exp (Constr (Let (["_12"], Exp (Constr (List (LL [Exp (Constr (Var "Y"))] (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "++"))))) [Exp (Constr (Var "Ys")), Exp (Constr (List (LL [Exp (Constr (Tuple [Exp (Constr (Var "Msg")), Exp (Constr (Lit (LAtom (Atom "none"))))]))] (Exp (Constr (Lit LNil))))))]))))))) (Exp (Constr (App (Exp (Constr (Fun (Function (Atom "make", 3))))) [Exp (Constr (Lit LNil)), Exp (Constr (Var "_12")), Exp (Constr (Var "Z"))]))))))))))))), Constr (Alt (Pats []) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (Let (["_13"], Exp (Constr (List (LL [Exp (Constr (Var "Y"))] (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "++"))))) [Exp (Constr (Var "Ys")), Exp (Constr (List (LL [Exp (Constr (Tuple [Exp (Constr (Var "Msg")), Exp (Constr (Var "PID"))]))] (Exp (Constr (Lit LNil))))))]))))))) (Exp (Constr (App (Exp (Constr (Fun (Function (Atom "make", 3))))) [Exp (Constr (Lit LNil)), Exp (Constr (Var "_13")), Exp (Constr (Var "Z"))])))))))])))))))))), Constr (Alt (Pats [PTuple [PLit (LAtom (Atom "recv")), PVar "XPID"]]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (Seq (Exp (Constr (Case (Exp (Constr (Var "Y"))) [Constr (Alt (Pats [PTuple [PVar "Msg", PLit (LAtom (Atom "none"))]]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (Let (["_15"], Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "self"))))) []))) (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "!"))))) [Exp (Constr (Var "XPID")), Exp (Constr (Tuple [Exp (Constr (Var "_15")), Exp (Constr (Var "Msg"))]))]))))))), Constr (Alt (Pats [PTuple [PVar "Msg", PVar "YPID"]]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (Let (["_16"], Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "self"))))) []))) (Exp (Constr (Seq (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "!"))))) [Exp (Constr (Var "YPID")), Exp (Constr (Tuple [Exp (Constr (Lit (LAtom (Atom "ack")))), Exp (Constr (Var "_16"))]))]))) (Exp (Constr (Let (["_17"], Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "self"))))) []))) (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "!"))))) [Exp (Constr (Var "XPID")), Exp (Constr (Tuple [Exp (Constr (Var "_17")), Exp (Constr (Var "Msg"))]))]))))))))))))), Ann (Alt (Pats [PVar "_18"]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (Op (Atom "match_fail") [Exp (Constr (Tuple [Exp (Constr (Lit (LAtom (Atom "case_clause")))), Exp (Constr (Var "_18"))]))])))) [CLit (LAtom (Atom "compiler_generated"))]]))) (Exp (Constr (App (Exp (Constr (Fun (Function (Atom "make", 3))))) [Exp (Constr (Lit LNil)), Exp (Constr (Var "Ys")), Exp (Constr (Var "Z"))])))))))] (TimeOut (Exp (Constr (Lit (LAtom (Atom "infinity"))))) (Exp (Constr (Lit (LAtom (Atom "true")))))))))), Constr (Alt (Pats [PList (LL [PVar "X"] (PVar "Xs")), PList (LL [PVar "Y"] (PVar "Ys")), PVar "Z"]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (Seq (Exp (Constr (Case (Exp (Constr (Var "Y"))) [Constr (Alt (Pats [PTuple [PVar "Msg", PLit (LAtom (Atom "none"))]]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (Let (["_19"], Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "self"))))) []))) (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "!"))))) [Exp (Constr (Var "X")), Exp (Constr (Tuple [Exp (Constr (Var "_19")), Exp (Constr (Var "Msg"))]))]))))))), Constr (Alt (Pats [PTuple [PVar "Msg", PVar "YPID"]]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (Let (["_20"], Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "self"))))) []))) (Exp (Constr (Seq (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "!"))))) [Exp (Constr (Var "YPID")), Exp (Constr (Tuple [Exp (Constr (Lit (LAtom (Atom "ack")))), Exp (Constr (Var "_20"))]))]))) (Exp (Constr (Let (["_21"], Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "self"))))) []))) (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "!"))))) [Exp (Constr (Var "X")), Exp (Constr (Tuple [Exp (Constr (Var "_21")), Exp (Constr (Var "Msg"))]))]))))))))))))), Ann (Alt (Pats [PVar "_22"]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Constr (Op (Atom "match_fail") [Exp (Constr (Tuple [Exp (Constr (Lit (LAtom (Atom "case_clause")))), Exp (Constr (Var "_22"))]))])))) [CLit (LAtom (Atom "compiler_generated"))]]))) (Exp (Constr (App (Exp (Constr (Fun (Function (Atom "make", 3))))) [Exp (Constr (Var "Xs")), Exp (Constr (Var "Ys")), Exp (Constr (Var "Z"))]))))))), Ann (Alt (Pats [PVar "_25", PVar "_24", PVar "_23"]) (Guard (Exp (Constr (Lit (LAtom (Atom "true")))))) (Exp (Ann (Op (Atom "match_fail") [Exp (Constr (Tuple [Exp (Constr (Lit (LAtom (Atom "function_clause")))), Exp (Constr (Var "_25")), Exp (Constr (Var "_24")), Exp (Constr (Var "_23"))]))]) [CTuple [CLit (LAtom (Atom "function_name")), CTuple [CLit (LAtom (Atom "make")), CLit (LInt 3)]]]))) [CLit (LAtom (Atom "compiler_generated"))]]))))),
    FunDef (Constr (Function (Atom "send", 2))) (Constr (Lambda ["_0", "_1"] (Exp (Constr (Let (["_2"], Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "self"))))) []))) (Exp (Constr (Seq (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "!"))))) [Exp (Constr (Var "_0")), Exp (Constr (Tuple [Exp (Constr (Lit (LAtom (Atom "send")))), Exp (Constr (Var "_1")), Exp (Constr (Var "_2"))]))]))) (Exp (Constr (Rec [Constr (Alt (Pats [PTuple [PLit (LAtom (Atom "ack")), PVar "_5"]]) (Guard (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "=:="))))) [Exp (Constr (Var "_5")), Exp (Constr (Var "_0"))])))) (Exp (Constr (Lit (LAtom (Atom "ok"))))))] (TimeOut (Exp (Constr (Lit (LAtom (Atom "infinity"))))) (Exp (Constr (Lit (LAtom (Atom "true"))))))))))))))))),
    FunDef (Constr (Function (Atom "recv", 1))) (Constr (Lambda ["_0"] (Exp (Constr (Let (["_1"], Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "self"))))) []))) (Exp (Constr (Seq (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "!"))))) [Exp (Constr (Var "_0")), Exp (Constr (Tuple [Exp (Constr (Lit (LAtom (Atom "recv")))), Exp (Constr (Var "_1"))]))]))) (Exp (Constr (Rec [Constr (Alt (Pats [PTuple [PVar "_3", PVar "Msg"]]) (Guard (Exp (Constr (ModCall (Exp (Constr (Lit (LAtom (Atom "erlang")))), Exp (Constr (Lit (LAtom (Atom "=:="))))) [Exp (Constr (Var "_3")), Exp (Constr (Var "_0"))])))) (Exp (Constr (Var "Msg"))))] (TimeOut (Exp (Constr (Lit (LAtom (Atom "infinity"))))) (Exp (Constr (Lit (LAtom (Atom "true")))))))))))))))))
  ]
